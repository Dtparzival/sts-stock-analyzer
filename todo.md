# 美股投資分析平台 TODO

## 核心功能

- [x] 股票搜尋功能
  - [x] 股票代碼搜尋
  - [x] 公司名稱搜尋
  - [x] 搜尋結果展示

- [x] 股票資訊展示
  - [x] 即時股價資訊
  - [x] 歷史價格圖表
  - [x] 公司基本資料
  - [x] 財務指標

- [x] 投資分析功能
  - [x] 技術分析指標
  - [x] 基本面分析
  - [x] AI 驅動的投資建議
  - [x] 風險評估

- [x] 未來趨勢預測
  - [x] 價格趨勢預測
  - [x] 市場情緒分析
  - [x] 行業比較分析

- [x] 用戶功能
  - [x] 收藏股票列表
  - [x] 個人投資組合追蹤
  - [x] 歷史查詢記錄

## 技術實作

- [x] 整合股票數據API
- [x] 設計資料庫架構
- [x] 實作後端 tRPC procedures
- [x] 設計前端 UI/UX
- [x] 實作圖表視覺化
- [x] 整合 LLM 進行分析析

## 優化與測試

- [x] 效能優化
- [x] 錯誤處理
- [x] 響應式設計
- [x] 跨瀏覽器測試

## 新增功能：互動式股價走勢圖

- [x] 安裝 Recharts 圖表庫
- [x] 創建股價走勢圖表組件
- [x] 實作多時間範圍切換（1天、5天、1個月、3個月、1年、5年）
- [x] 整合圖表到股票詳情頁面
- [x] 添加圖表互動功能（懸停顯示數據點）
- [x] 優化圖表載入狀態和錯誤處理
- [x] 測試圖表在不同時間範圍的顯示效果

## 新增功能：自訂日期範圍查詢

- [x] 安裝日期選擇器組件庫
- [x] 創建日期範圍選擇器UI
- [x] 實作日期驗證邏輯（起始日期不能晚於結束日期）
- [x] 整合日期選擇器到股價圖表組件
- [x] 更新後端API支援自訂日期範圍查詢
- [x] 添加日期格式化和顯示
- [x] 測試不同日期範圍的查詢功能

## 新增功能：主題調整與功能完善

### 淺色主題
- [x] 更新 App.tsx 主題設定為 light
- [x] 調整 index.css 淺色主題配色
- [x] 測試所有頁面在淺色主題下的顯示效果

### 投資組合功能完善
- [x] 設計投資組合資料庫表結構
- [x] 實作新增持股功能（股票代碼、購買價格、數量、購買日期）
- [x] 實作編輯持股功能（可通過刪除再新增實現）
- [x] 實作刪除持股功能
- [x] 計算投資組合總價值和損益
- [x] 顯示每支股票的當前價格和損益百分比
- [x] 添加投資組合圖表視覺化

### AI 投資顧問
- [x] 整合 AIChatBox 組件
- [x] 創建 AI 顧問頁面或側邊欄
- [x] 實作後端 LLM 整合處理用戶提問
- [x] 支援股票相關問題回答
- [x] 測試 AI 對話功能（需要用戶登入）

## 新增需求：UI/UX 改進

- [x] 修正首頁功能卡片點擊事件（即時股票數據、AI 投資分析）
- [x] 新增用戶登出按鈕到頂部導航欄
- [x] 將 AI 投資顧問改為浮動聊天按鈕（右下角）
- [x] 實作 AI 顧問彈出視窗功能
- [x] 測試所有點擊和互動功能

## 新增需求：修正顯示問題與功能增強

- [x] 修正 AI 投資顧問聊天視窗的文字排版問題
- [x] 為投資分析頁面添加「重新生成分析」按鈕
- [x] 為投資分析頁面添加「下載 PDF 報告」按鈕
- [x] 實作 PDF 報告生成功能
- [x] 測試所有新增功能

## 新增需求：修正功能問題

- [x] 修正未登入用戶無法使用網站基本功能的問題
- [x] 允許未登入用戶查看股票資訊和AI分析
- [x] 修正 PDF 下載功能錯誤（已移除功能）
- [x] 移除投資分析和趨勢預測的「重新生成」按鈕
- [x] 調整緩存機制確保分析結果為最新時間
- [x] 測試所有修正功能

## 新增問題：圖表時間區間切換無反應

- [x] 檢查 StockChart 組件的時間範圍切換邏輯
- [x] 修正時間區間按鈕點擊無反應的問題
- [x] 確保圖表數據根據選擇的時間範圍正確更新
- [x] 測試所有時間範圍按鈕（1天、5天、1個月、3個月、1年、5年）

## 新增問題：圖表時間區間按鈕選中狀態不同步

- [x] 修正 StockChart 組件的按鈕選中狀態同步問題
- [x] 確保按鈕高亮狀態跟隨用戶選擇更新
- [x] 測試所有時間範圍按鈕的選中狀態顯示

## 新增需求：未來趨勢預測以系統日期為起算點

- [x] 檢查當前趨勢預測的實作邏輯
- [x] 修正趨勢預測 prompt，明確指定以系統當前日期為起算點
- [x] 確保預測結果包含具體的未來日期範圍
- [x] 測試趨勢預測功能確認日期正確

## 新增需求：更新版權年份

- [x] 將首頁頁尾的版權年份從 2024 更新為 2025
- [x] 測試頁面顯示確認修改正確

## 新增問題：未來趨勢預測數據不是最新的

- [x] 檢查趨勢預測的數據來源和緩存機制
- [x] 確保趨勢預測使用最新的股價數據
- [x] 在 prompt 中明確說明當前最新的股價和日期
- [x] 調整緩存策略確保數據時效性
- [x] 測試修正後的趨勢預測功能

## 新增問題：投資組合當前價格無法顯示

- [x] 檢查投資組合頁面的當前價格獲取邏輯
- [x] 修正股票即時價格 API 調用問題
- [x] 確保損益和報酬率能正確計算
- [x] 測試投資組合頁面的所有功能

## 新增功能：投資組合歷史追蹤

- [x] 設計 portfolioHistory 資料庫表結構
- [x] 實作每日記錄投資組合價值的後端邏輯
- [x] 開發獲取歷史數據的 tRPC API
- [x] 實作績效曲線圖組件（使用 recharts）
- [x] 添加時間範圍選擇器（7天、30天、90天、全部）
- [x] 顯示累計報酬率變化趨勢
- [x] 測試歷史追蹤功能

## 新增功能：持倉分析儀表板

- [x] 實作持倉分布圓餅圖（按股票代碼）
- [x] 開發產業配置分析功能
- [x] 實作風險評估指標（集中度、波動性）
- [x] 設計並實作分析儀表板 UI
- [x] 添加投資建議功能
- [x] 測試分析儀表板功能

## 新增問題：手機版頂部導航欄跑版

- [x] 檢查頂部導航欄的響應式設計
- [x] 修正手機版標題和按鈕的排版
- [x] 確保所有導航按鈕在小螢幕上完整顯示
- [x] 調整按鈕間距和大小適應手機螢幕
- [x] 測試修正後的手機顯示效果
